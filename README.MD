# –ü—Ä–∞–∫—Ç–∏–∫—É–º –ø–æ –∫—É—Ä—Å—É "–í–≤–µ–¥–µ–Ω–∏–µ –≤ Kubernetes"

**–î–∏–ø–ª–æ–º–Ω—ã–π –ø—Ä–æ–µ–∫—Ç - –ó–∞–¥–∞–Ω–∏–µ "Nightmare" (–Ω–∞ —á–µ—Ç–≤–µ—Ä–æ—á–∫—É)**

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è](#–æ–ø–∏—Å–∞–Ω–∏–µ-—Ä–µ—à–µ–Ω–∏—è)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∑–∞–¥–∞–Ω–∏—è "Nightmare"](#—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º-–∑–∞–¥–∞–Ω–∏—è-nightmare)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-–¥–µ—Ç–∞–ª–∏)
- [–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞](#–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞)
- [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
- [–ê–≤—Ç–æ—Ä](#–∞–≤—Ç–æ—Ä)

---

## –û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö MongoDB, 
—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–µ –≤ Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Ingress Controller –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑–≤–Ω–µ.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è:**

1. **MongoDB** - –∫–ª–∞—Å—Ç–µ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
   - –û–±—Ä–∞–∑: `mongo:7.0`
   - Replicas: 1
   - –•—Ä–∞–Ω–∏–ª–∏—â–µ: emptyDir (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ, –∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤ –∑–∞–¥–∞–Ω–∏–∏)
   - –ü–æ—Ä—Ç: 27017
   - Service: ClusterIP

2. **–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** - Mongo Express (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å MongoDB)
   - –û–±—Ä–∞–∑: `mongo-express:1.0.2`
   - Replicas: 2 (–¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏)
   - –ü–æ—Ä—Ç: 8081 (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π), 80 (Service)
   - Service: ClusterIP

3. **Ingress Controller** - Traefik v2.10
   - –í—ã–±—Ä–∞–Ω Traefik (–Ω–µ ingress-nginx, –∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤ –∑–∞–¥–∞–Ω–∏–∏)
   - Replicas: 2
   - –î–æ—Å—Ç—É–ø: NodePort 30080 (HTTP), 30081 (Dashboard)
   - Namespace: kube-system

4. **Ingress** - –ø—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
   - Host: webapp.local
   - Path: /
   - Backend: webapp service (port 80)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ga_kubernetes/
‚îú‚îÄ‚îÄ deploy/                          # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ 01-namespace.yaml           # Namespace –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ 02-mongodb-deployment.yaml  # Deployment MongoDB
‚îÇ   ‚îú‚îÄ‚îÄ 03-mongodb-service.yaml     # Service –¥–ª—è MongoDB
‚îÇ   ‚îú‚îÄ‚îÄ 04-webapp-deployment.yaml   # Deployment –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ 05-webapp-service.yaml      # Service –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ 06-traefik-rbac.yaml        # RBAC –¥–ª—è Traefik
‚îÇ   ‚îú‚îÄ‚îÄ 07-traefik-deployment.yaml  # Deployment Traefik
‚îÇ   ‚îú‚îÄ‚îÄ 08-traefik-service.yaml     # Service –¥–ª—è Traefik (NodePort)
‚îÇ   ‚îú‚îÄ‚îÄ 09-ingressclass.yaml        # IngressClass –¥–ª—è Traefik
‚îÇ   ‚îî‚îÄ‚îÄ 10-webapp-ingress.yaml      # Ingress –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ README.MD                        # –û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
‚îî‚îÄ‚îÄ DEPLOY.MD                        # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

```

## –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∑–∞–¥–∞–Ω–∏—è "Nightmare"

‚úÖ **–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö** - Mongo Express + MongoDB  
‚úÖ **–ö–ª–∞—Å—Ç–µ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - MongoDB (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é)  
‚úÖ **Ingress Controller** - Traefik (–Ω–µ ingress-nginx)  
‚úÖ **–î–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ Ingress —Å NodePort** - NodePort 30080  
‚úÖ **–•—Ä–∞–Ω–∏–ª–∏—â–µ emptyDir** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è MongoDB  

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

**Namespace:** `webapp` - –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
**Ingress Controller Namespace:** `kube-system` 
- —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–ü–æ—Ä—Ç—ã:**
- NodePort 30080 - HTTP –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é —á–µ—Ä–µ–∑ Traefik
- NodePort 30081 - Traefik Dashboard (–¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)

**Credentials:**
- MongoDB: admin / password123
- Mongo Express UI: admin / pass

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **emptyDir –¥–ª—è MongoDB** - –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–∞ –Ω–æ–¥–µ, 
–ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ Pod –¥–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è (–∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤ –∑–∞–¥–∞–Ω–∏–∏)
2. **Traefik –∫–∞–∫ Ingress Controller** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π, 
–ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. **Mongo Express** - —É–¥–æ–±–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å MongoDB
4. **2 —Ä–µ–ø–ª–∏–∫–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** - –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ Ingress
5. **RBAC –Ω–∞—Å—Ç—Ä–æ–µ–Ω** - ServiceAccount, ClusterRole –∏ ClusterRoleBinding –¥–ª—è Traefik

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:
- **HTTP:** `http://<NODE_IP>:30080` —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `Host: webapp.local`
- **Traefik Dashboard:** `http://<NODE_IP>:30081`

–ü—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
```bash
curl -H "Host: webapp.local" http://<NODE_IP>:30080
```

–ò–ª–∏ –¥–æ–±–∞–≤–ª—è–µ–º –≤ `/etc/hosts` (Linux/Mac) –∏–ª–∏ `C:\Windows\System32\drivers\etc\hosts` (Windows):
```
<NODE_IP> webapp.local
```

–ò –æ—Ç–∫—Ä—ã–≤–∞–µ–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://webapp.local:30080`

## –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞

–†–µ—à–µ–Ω–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è:
- **Kubernetes:** v1.34
- **StorageClass:** csi-driver-lvm-linear (–¥–æ—Å—Ç—É–ø–µ–Ω, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏)
- **–î–æ—Å—Ç—É–ø –∫ Docker Hub:** –µ—Å—Ç—å
- **–ò–Ω—Ç–µ—Ä–Ω–µ—Ç:** –µ—Å—Ç—å

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

–ü–æ–¥—Ä–æ–±–Ω–∞—è –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ Kubernetes:

üìñ **[–ü–µ—Ä–µ–π—Ç–∏ –∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é (DEPLOY.MD)](DEPLOY.MD)**

**–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:**
```bash
# –ü—Ä–∏–º–µ–Ω—è–µ–º –≤—Å–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã
kubectl apply -f deploy/

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
kubectl get all -n webapp
kubectl get ingress -n webapp
```

–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:
üìã **[–í—Å–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (cmds.sh)](cmds.sh)**

## –ê–≤—Ç–æ—Ä

–ò–∫–æ–Ω–Ω–∏–∫–æ–≤ –ú–∏—Ö–∞–∏–ª <mishaikon@gmail.com>
